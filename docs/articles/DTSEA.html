<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="DTSEA">
<title>DTSEA User Guide â€¢ DTSEA</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="DTSEA User Guide">
<meta property="og:description" content="DTSEA">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">DTSEA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/DTSEA.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/hanjunwei-lab/DTSEA/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>DTSEA User Guide</h1>
                        <h4 data-toc-skip class="author">Yinchun Su,
Junwei Han</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/hanjunwei-lab/DTSEA/blob/HEAD/vignettes/DTSEA.Rmd" class="external-link"><code>vignettes/DTSEA.Rmd</code></a></small>
      <div class="d-none name"><code>DTSEA.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hanjunwei-lab/DTSEA" class="external-link">DTSEA</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; This package SHOULD NOT BE USED UNDER INTEL MATH KERNEL LIBRARY ON ANY OCCASION.</span></span>
<span><span class="co">#&gt; There is an avoidable but critical bug with Intel Math Kernel Library (MKL) on various operating systems.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ======================================</span></span>
<span><span class="co">#&gt; For better performance, we recommend not using RStudio on Windows because RStudio cannot take advantage of the multi-core capabilities available on modern computers.</span></span></code></pre></div>
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>The Drug Target Set Enrichment Analysis (DTSEA) is a novel tool used
to identify the most effective drug set against a particular disease
based on the Gene Set Enrichment Analysis (GSEA).</p>
<p>The central hypothesis of DTSEA is that the targets of potential
candidates for a specific disease (e.g., COVID-19) ought to be close to
each other, or at least not so far away from the disease. The DTSEA
algorithm determines whether a drug is potent for the chosen disease by
the proximity between drug targets and the disease-related genes. Under
the central hypothesis of DTSEA, the DTSEA consists of two main
parts:</p>
<ol style="list-style-type: decimal">
<li>Evaluate the influence of the specific disease in the PPI network by
the random walk with restart algorithm.</li>
</ol>
<p>To evaluate the influence, we compute the disease-node distance by
using the random walk with restart (RwR) algorithm, then rank the nodes
reversely.</p>
<ol start="2" style="list-style-type: decimal">
<li>Evaluate the drug-disease associations based on GSEA.</li>
</ol>
<p>The GSEA approach is adopted in this part to identify whether
candidate drug targets are disease-related (top) or disease-unrelated
(bottom) on the human PPI list. The specific disease gene list is
normalized by the median and is set zero as the arbitrary cutoff point
to classify the relations manually.</p>
<p>This vignette illustrates how to use the <strong>DTSEA</strong>
easily. Here, using functions in this package, users could identify
potential drugs for disease by the DTSEA algorithm.</p>
</div>
<div class="section level3">
<h3 id="example-1-calculate-the-enrichment-scores-of-drugs-">Example 1: Calculate the enrichment scores of drugs.<a class="anchor" aria-label="anchor" href="#example-1-calculate-the-enrichment-scores-of-drugs-"></a>
</h3>
<p>The function <code>DTSEA</code> is used to calculate the enrichment
scores of drugs. The parameters are as follows:</p>
<ul>
<li>
<code>network</code>: The human protein-protein interactome network.
It should be or be preconverted before being inputted in DTSEA.</li>
<li>
<code>disease</code>: The disease-related nodes.</li>
<li>
<code>drugs</code>: The drug-target long format dataframe. It
includes at least columns with the drug_id and drug_target.</li>
<li>
<code>rwr.pt</code>: The random walk p0 vector. Set it to zero if
you wish DTSEA automatically compute it, or you can provide your
predetermined p0 vector.</li>
<li>
<code>eps</code>: The boundary of calculating the p value.</li>
<li>
<code>nPermSimple</code>: Number of permutations in the simple fgsea
implementation for preliminary estimation of p-values.</li>
<li>
<code>gseaParam</code>: GSEA parameter value, all gene-level
statistics are raised to the power of â€˜gseaParamâ€™ before calculating
GSEA enrichment scores.</li>
<li>
<code>verbose</code>: Show the messages.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"example_disease_list"</span>, package <span class="op">=</span> <span class="st">"DTSEA"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"example_drug_target_list"</span>, package <span class="op">=</span> <span class="st">"DTSEA"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"example_ppi"</span>, package <span class="op">=</span> <span class="st">"DTSEA"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform a simple DTSEA analysis using default optional parameters then sort</span></span>
<span><span class="co"># the result dataframe by normalized enrichment scores (NES)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DTSEA.html">DTSEA</a></span><span class="op">(</span>network <span class="op">=</span> <span class="va">example_ppi</span>,</span>
<span>                disease <span class="op">=</span> <span class="va">example_disease_list</span>,</span>
<span>                drugs <span class="op">=</span> <span class="va">example_drug_target_list</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">NES</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in preparePathwaysAndStats(pathways, stats, minSize, maxSize, gseaParam, : There are ties in the preranked stats (0.81% of the list).</span></span>
<span><span class="co">#&gt; The order of those tied genes will be arbitrary, which may produce unexpected results.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 Ã— 8</span></span></span>
<span><span class="co">#&gt;   drug_id    pval   padj log2err    ES   NES  size leadingEdge</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> DB00112 0.004<span style="text-decoration: underline;">89</span> 0.030<span style="text-decoration: underline;">9</span>  0.407  0.729  1.84     9 <span style="color: #949494;">&lt;chr [4]&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> DB09079 0.096<span style="text-decoration: underline;">9</span>  0.266   0.092<span style="text-decoration: underline;">8</span> 0.509  1.40    12 <span style="color: #949494;">&lt;chr [10]&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> DB11952 0.067<span style="text-decoration: underline;">1</span>  0.255   0.111  0.890  1.38     2 <span style="color: #949494;">&lt;chr [2]&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> DB05017 0.100   0.266   0.090<span style="text-decoration: underline;">4</span> 0.866  1.35     2 <span style="color: #949494;">&lt;chr [2]&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> DB11526 0.161   0.339   0.070<span style="text-decoration: underline;">1</span> 0.681  1.31     4 <span style="color: #949494;">&lt;chr [4]&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> DB01611 0.203   0.350   0.062<span style="text-decoration: underline;">1</span> 0.719  1.26     3 <span style="color: #949494;">&lt;chr [3]&gt;</span></span></span></code></pre></div>
<p>You can arrange the positive results by NES</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">result</span>, <span class="op">-</span><span class="va">leadingEdge</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">NES</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">NES</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">pval</span> <span class="op">&lt;</span> <span class="fl">.05</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 Ã— 7</span></span></span>
<span><span class="co">#&gt;   drug_id    pval   padj log2err    ES   NES  size</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> DB00112 0.004<span style="text-decoration: underline;">89</span> 0.030<span style="text-decoration: underline;">9</span>   0.407 0.729  1.84     9</span></span></code></pre></div>
<p>Or we can draw the enrichment plot of the first predicted drug using
<code>fgsea</code> package.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fgsea</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fgsea/man/plotEnrichment.html" class="external-link">plotEnrichment</a></span><span class="op">(</span></span>
<span>  pathway <span class="op">=</span> <span class="va">example_drug_target_list</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">drug_id</span> <span class="op">==</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="va">result</span>, <span class="fl">1</span><span class="op">)</span><span class="op">$</span><span class="va">drug_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">gene_target</span><span class="op">)</span>,</span>
<span>  stats <span class="op">=</span> <span class="fu"><a href="../reference/random.walk.html">random.walk</a></span><span class="op">(</span>network <span class="op">=</span> <span class="va">example_ppi</span>,</span>
<span>                      p0 <span class="op">=</span> <span class="fu"><a href="../reference/calculate_p0.html">calculate_p0</a></span><span class="op">(</span>nodes <span class="op">=</span> <span class="va">example_ppi</span>,</span>
<span>                                        disease <span class="op">=</span> <span class="va">example_disease_list</span><span class="op">)</span></span>
<span>                      <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="DTSEA_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="example-2--get-the-influence-of-the-specific-disease-in-the-ppi-network">Example 2. Get the influence of the specific disease in the PPI
network<a class="anchor" aria-label="anchor" href="#example-2--get-the-influence-of-the-specific-disease-in-the-ppi-network"></a>
</h3>
<p>The function <code>random.walk</code> calculates the <code>pt</code>
vector. The parameters are as follows:</p>
<ul>
<li>
<code>network</code> The input graph object. It should be either
igraph object or edge list matrix / data frame.</li>
<li>
<code>p0</code> The starting vector on time 0.</li>
<li>
<code>edge_weight</code> Logical to indicate whether the input graph
contains weight information.</li>
<li>
<code>gamma</code> The restart probability used for RwR. The
<code>gamma</code> takes the value from 0 to 1, controlling the
probability that a node would go back to its starting node.</li>
<li>
<code>threshold</code> The threshold used for RwR. The
<code>threshold</code> indicates the stabilization status, which is a
stopping criterion of RwR.</li>
<li>
<code>pt.post.processing</code> The way to scale the <code>pt</code>
vector. It can be â€˜noneâ€™, â€˜zscoreâ€™, and â€˜logâ€™.</li>
<li>
<code>pt.align</code> The way to normalize the output
<code>pt</code> vector. It can be â€˜meanâ€™ to manually cut the up- and
down-regulated genes, â€˜medianâ€™ to avoid the influence of the
distribution shape, or â€˜noneâ€™ for no normalization.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate p0</span></span>
<span><span class="va">p0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_p0.html">calculate_p0</a></span><span class="op">(</span>nodes <span class="op">=</span> <span class="va">example_ppi</span>, disease <span class="op">=</span> <span class="va">example_disease_list</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Then perform random walk</span></span>
<span><span class="fu"><a href="../reference/random.walk.html">random.walk</a></span><span class="op">(</span>network <span class="op">=</span> <span class="va">example_ppi</span>, p0 <span class="op">=</span> <span class="va">p0</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;    MYD88   MAPK14    TRAF1     JAK2      AGT    IRAK2 </span></span>
<span><span class="co">#&gt; 5.010910 4.994586 4.985955 4.970095 4.964825 4.959323</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-3--calculate-the-consistency-of-the-prediction">Example 3. Calculate the consistency of the prediction<a class="anchor" aria-label="anchor" href="#example-3--calculate-the-consistency-of-the-prediction"></a>
</h3>
<p>The function <code>cronbach.alpha</code> and <code>kendall.w</code>
are used to calculate the prediction consistency.</p>
<p>If you have several prediction results, you can use either function
to describe the consistency.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Just report the results</span></span>
<span><span class="fu"><a href="../reference/kendall.w.html">kendall.w</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">$</span><span class="va">report</span></span>
<span><span class="co">#&gt; [1] "Kendall's coefficient W = 0.752, p = 0.0897"</span></span>
<span></span>
<span><span class="co"># Or just report the alpha</span></span>
<span><span class="fu"><a href="../reference/cronbach.alpha.html">cronbach.alpha</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.7232358</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="multicore-capability">Multicore capability<a class="anchor" aria-label="anchor" href="#multicore-capability"></a>
</h3>
<p>You can enable the multicore feature to utilize the multicore
advantages. Here is the benchmark.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set up environment</span></span>
<span></span>
<span><span class="va">single.core</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/capture.output.html" class="external-link">capture.output</a></span><span class="op">(</span><span class="fu"><a href="../reference/DTSEA.html">DTSEA</a></span><span class="op">(</span>network <span class="op">=</span> <span class="va">example_ppi</span>, disease <span class="op">=</span> <span class="va">example_disease_list</span>, drugs <span class="op">=</span> <span class="va">example_drug_target_list</span>, nproc <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="cn">NULL</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">dual.core</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/capture.output.html" class="external-link">capture.output</a></span><span class="op">(</span><span class="fu"><a href="../reference/DTSEA.html">DTSEA</a></span><span class="op">(</span>network <span class="op">=</span> <span class="va">example_ppi</span>, disease <span class="op">=</span> <span class="va">example_disease_list</span>, drugs <span class="op">=</span> <span class="va">example_drug_target_list</span>, nproc <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="cn">NULL</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu">single.core</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu">dual.core</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="supplementary-data-files">Supplementary data files<a class="anchor" aria-label="anchor" href="#supplementary-data-files"></a>
</h3>
<p>In this package, we provide the example data, which is a small set of
data to demonstrate the usage and the main idea behind DTSEA. We provide
some extra data files, the real data we used in the DTSEA paper. The
supplementary package is now on the <a href="https://github.com/hanjunwei-lab/DTSEAdata" class="external-link">GitHub</a>. Anyone can
obtain this package by:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="st">"devtools"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html" class="external-link">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">Package</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"hanjunwei-lab/DTSEAdata"</span><span class="op">)</span></span></code></pre></div>
<p>Here is a list of the supplementary datasets</p>
<table class="table">
<colgroup>
<col width="26%">
<col width="73%">
</colgroup>
<thead><tr class="header">
<th align="left">Data name</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>deletion</code></td>
<td align="left">Drug prediction results on trimmed graphs after
enrichment</td>
</tr>
<tr class="even">
<td align="left"><code>drug_indications</code></td>
<td align="left">The drug indications data from ChEMBL</td>
</tr>
<tr class="odd">
<td align="left"><code>drug_predicted</code></td>
<td align="left">The drug target data predicted by ChEMBL</td>
</tr>
<tr class="even">
<td align="left"><code>drug_targets</code></td>
<td align="left">The combined drug target data</td>
</tr>
<tr class="odd">
<td align="left"><code>expr_raw</code></td>
<td align="left">The raw expression profile of GSE164805</td>
</tr>
<tr class="even">
<td align="left"><code>graph</code></td>
<td align="left">The human gene functional interaction network we
used</td>
</tr>
<tr class="odd">
<td align="left"><code>ncbi_list</code></td>
<td align="left">The COVID-19-related genes provided by NCBI</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="known-bugs">Known bugs<a class="anchor" aria-label="anchor" href="#known-bugs"></a>
</h2>
<p>The Intel Math Kernel Library (MKL) performs poorly with this package
when dealing with linear algebra operations. If you use MKL-based BLAS
or MKL-based R distribution (like <a href="https://mran.microsoft.com/" class="external-link">Microsoft R Open</a>), you will get
unexpected or zero results in certain circumstances. Please install the
Automatically Tuned Linear Algebra package (libatlas) or the
multi-threaded OpenBlas library in order to get higher performance and
reliable results with:</p>
<pre><code>sudo apt install libatlas3-base -y</code></pre>
<p>or</p>
<pre><code>sudo apt install libopenblas-base -y</code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Junwei Han, Yinchun Su.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
